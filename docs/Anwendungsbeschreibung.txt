# Anwendungsbeschreibung: Nodal Staging Analysis Tool (Version 3.2.0)

## 1. Einleitung

### 1.1. Zweck und Geltungsbereich
Das **Nodal Staging: Avocado Sign vs. T2 Criteria** Analysis Tool ist eine client-seitige Webanwendung, die für die **wissenschaftliche Forschung** in der radiologischen Diagnostik des Rektumkarzinoms entwickelt wurde. Sie bietet eine interaktive Plattform zur umfassenden Analyse und zum Vergleich der diagnostischen Güte verschiedener MRT-basierter Kriterien für die Beurteilung des mesorektalen Lymphknotenstatus (N-Status).

Der Fokus der Anwendung liegt auf der Evaluation des innovativen **Avocado Sign (AS)** im direkten Vergleich mit:
* Etablierten, literaturbasierten T2-gewichteten (T2w) morphologischen Kriterien.
* Datengetriebenen, kohorten-optimierten T2w-Kriterien, die mithilfe einer integrierten Brute-Force-Analyse ermittelt werden.

Die Anwendung unterstützt den gesamten Forschungsprozess, von der Datenexploration über detaillierte statistische Analysen bis hin zur Erstellung von Manuskriptentwürfen, die den Publikationsanforderungen medizinisch-radiologischer Fachjournale (z.B. *Radiology*) entsprechen.

### 1.2. Wichtiger Hinweis: Forschungsinstrument
**Disclaimer:** Diese Anwendung ist ausschließlich für **Forschungs- und Bildungszwecke** konzipiert. Die dargestellten Daten, Statistiken und generierten Texte basieren auf einem statischen, pseudonymisierten Forschungsdatensatz. **Die Ergebnisse dürfen nicht für die klinische Diagnostik, direkte Behandlungsentscheidungen oder andere primäre medizinische Anwendungen herangezogen werden.** Die wissenschaftliche und klinische Verantwortung für die Interpretation und Verwendung der generierten Ergebnisse liegt allein beim Nutzer.

### 1.3. Systemanforderungen & Einrichtung
* **Systemanforderungen:** Ein moderner Desktop-Webbrowser (z.B. aktuelle Versionen von Google Chrome, Mozilla Firefox, Microsoft Edge oder Safari). Die Nutzung von Web Workers wird für die Brute-Force-Optimierung vorausgesetzt.
* **Einrichtung:** Es ist keine Installation erforderlich. Die Anwendung wird durch Öffnen der Datei `index.html` direkt im Browser ausgeführt. Eine Internetverbindung wird für das Laden externer Bibliotheken von Content Delivery Networks (CDNs) benötigt.

## 2. Globale Bedienkonzepte

Die Benutzeroberfläche ist darauf ausgelegt, einen intuitiven und effizienten wissenschaftlichen Arbeitsablauf zu unterstützen.

### 2.1. Anwendungs-Layout
* **Header:** Ein feststehender Kopfbereich enthält den Titel der Anwendung, die globale Kohortenauswahl sowie dynamische Meta-Statistiken zur aktuell gewählten Datenbasis.
* **Navigationsleiste (Tabs):** Eine horizontale Reiter-Navigation ermöglicht den schnellen Wechsel zwischen den sechs Hauptmodulen (Tabs) der Anwendung.
* **Inhaltsbereich:** Der zentrale Arbeitsbereich, in dem die spezifischen Inhalte und Werkzeuge des jeweils aktiven Tabs dargestellt werden.

### 2.2. Globale Kohortenauswahl
Die globale Kohortenauswahl ist ein zentrales Bedienkonzept. Drei Buttons im Header filtern den gesamten Datensatz für alle nachfolgenden Analysen und Darstellungen:
* **Overall:** Enthält alle 106 Patienten des pseudonymisierten Datensatzes.
* **Surgery alone:** Filtert die Patienten, die primär chirurgisch behandelt wurden.
* **Neoadjuvant therapy:** Filtert die Patienten, die eine neoadjuvante Radiochemotherapie erhalten haben.

Diese Auswahl ist global und wirkt sich unmittelbar auf alle angezeigten Daten, Tabellen, Grafiken und statistischen Berechnungen in allen Tabs aus.

### 2.3. Dynamische Header-Statistiken
Ein Bereich im Header zeigt eine Live-Zusammenfassung der Kennzahlen der aktiven Kohorte:
* **Cohort:** Zeigt den Namen der aktuell ausgewählten Kohorte an.
* **Patients:** Zeigt die Gesamtzahl der Patienten in der aktiven Kohorte.
* **N-Status, AS-Status, T2-Status:** Zeigen den prozentualen Anteil der positiven Patienten für den pathologischen N-Status, das Avocado Sign und die aktuell *interaktiv angewandten* T2-Kriterien an.

### 2.4. Interaktive Hilfe
* **Tooltips:** Fast alle UI-Elemente sind mit detaillierten Tooltips versehen, die bei Mouse-Over die Funktion des Elements oder die Definition einer Metrik erklären.
* **Quick Guide:** Ein **?**-Button im Header öffnet ein Modalfenster mit einer umfassenden Kurzanleitung zu allen Funktionen.

## 3. Die Anwendungsmodule im Detail (Tabs)

Die Anwendung ist in sechs Hauptmodule unterteilt, die über die Navigationsleiste zugänglich sind.

### 3.1. Data Tab
* **Zweck:** Dient der Darstellung und grundlegenden Exploration des zugrundeliegenden Patientendatensatzes.
* **Komponenten & Workflow:**
    * **Patiententabelle:** Eine interaktive, sortierbare Tabelle listet alle Patienten der gewählten Kohorte auf.
    * **Sortierung:** Ein Klick auf die Spaltenköpfe sortiert die Tabelle. Die Spalte "N/AS/T2" bietet ein spezielles Sub-Sorting durch Klick auf die Labels "N", "AS" oder "T2" im Spaltenkopf.
    * **Detailansicht (Lymphknoten):** Zeilen von Patienten mit T2-Lymphknotendaten sind erweiterbar und zeigen eine detaillierte Liste der morphologischen Eigenschaften jedes Knotens (Größe, Form, etc.).
    * **"Expand/Collapse All Details"-Button:** Blendet die Detailansicht für alle Patienten gleichzeitig ein oder aus.

### 3.2. Analysis Tab
* **Zweck:** Ermöglicht die interaktive Definition von T2-Kriterien, die Durchführung von Optimierungsanalysen und die Untersuchung der Kriterienauswirkungen auf Patientenebene.
* **Komponenten & Workflow:**
    * **Dashboard:** Bietet eine grafische Übersicht über die Verteilungen von Alter, Geschlecht, Therapie und Status-Markern in der aktuellen Kohorte.
    * **"Define T2 Malignancy Criteria"-Karte:** Das interaktive Werkzeug zur Definition von T2-Kriterien.
        * **Kriterien-Konfiguration:** Merkmale (Größe, Form, etc.) können per Checkbox aktiviert/deaktiviert und ihre Werte (z.B. Größenschwelle) per Slider oder Button-Klick eingestellt werden.
        * **Logik-Schalter:** Wechselt die logische Verknüpfung der aktiven Kriterien zwischen **AND** (alle Kriterien müssen erfüllt sein) und **OR** (mindestens ein Kriterium muss erfüllt sein).
        * **"Apply & Save"-Button:** Übernimmt die konfigurierten T2-Kriterien global für die gesamte Anwendung und speichert sie für zukünftige Sitzungen. Ein ungespeicherter Zustand wird durch einen gestrichelten Kartenrahmen signalisiert.
    * **"Diagnostic Performance (Applied T2)"-Karte:** Zeigt live die diagnostische Güte der aktuell angewandten T2-Einstellungen an.
    * **Brute-Force-Optimierung:** Dieser Bereich ist zweigeteilt:
        1.  **"Criteria Optimization (Brute-Force)"-Karte (Runner):** Hier kann eine neue Optimierungsanalyse gestartet werden. Der Nutzer wählt eine Zielmetrik (z.B. "Balanced Accuracy") und startet den Prozess. Ein Fortschrittsbalken informiert über den Status. Nach Abschluss können die besten gefundenen Kriterien direkt übernommen ("Apply Best") oder die Top-10-Ergebnisse in einem Detailfenster eingesehen werden ("Top 10").
        2.  **"Brute-Force Optima (Saved Results)"-Karte (Übersicht):** Diese Tabelle zeigt eine permanente Übersicht der **besten gespeicherten Ergebnisse** für jede Kohorte und jede bereits durchgeführte Zielmetrik. Diese Daten bleiben auch nach dem Schließen des Browsers erhalten.
    * **Analyse-Tabelle:** Visualisiert die Auswirkung der *aktuell angewandten* Kriterien auf Patientenebene. Erweiterbare Zeilen zeigen, welche Kriterien bei jedem einzelnen Lymphknoten erfüllt sind.

### 3.3. Statistics Tab
* **Zweck:** Bietet eine formale und umfassende statistische Auswertung der diagnostischen Leistung.
* **Komponenten & Workflow:**
    * **Ansicht-Umschalter ("Single View" / "Comparison Active"):** Wechselt zwischen der Analyse einer einzelnen Kohorte und dem direkten statistischen Vergleich zweier wählbarer Kohorten.
    * **Statistik-Karten:** Präsentieren detaillierte Ergebnisse zu: Deskriptiver Statistik, Diagnostischer Güte (AS vs. N und T2 vs. N), statistischen Vergleichstests (McNemar, DeLong) und Assoziationsanalysen.
    * **Criteria Comparison Table (nur in "Single View"):** Vergleicht die Performance des Avocado Signs mit den angewandten T2-Kriterien und vordefinierten Kriteriensätzen aus der Literatur.

### 3.4. Comparison Tab
* **Zweck:** Formatiert ausgewählte Analyseergebnisse visuell für Präsentationen und direkte Vergleiche.
* **Komponenten & Workflow:**
    * **Ansicht-Auswahl:** Fokussiert entweder auf die alleinige Performance des AS ("AS Performance") oder den direkten Vergleich mit T2-Kriterien ("AS vs. T2 Comparison").
    * **T2-Vergleichsbasis:** Im "AS vs. T2"-Modus kann der Nutzer wählen, ob das AS mit den interaktiv eingestellten Kriterien oder einem der vordefinierten Literatur-Kriteriensets verglichen werden soll.
    * **Dynamische Inhalte:** Generiert automatisch Vergleichstabellen, statistische Tests und ein Balkendiagramm. Alle Elemente sind als CSV, Markdown, PNG oder SVG exportierbar.

### 3.5. Publication Tab
* **Zweck:** Assistent zur Erstellung eines wissenschaftlichen Manuskripts nach den Stilrichtlinien des Fachjournals *Radiology*.
* **Komponenten & Workflow:**
    * **Titel-Seite & Gliederung:** Die Ansicht beginnt mit einer *Radiology*-konformen Titelseite (inkl. Key Results) und ist klar in Hauptabschnitte (Abstract, Introduction, etc.) gegliedert, die per Seitenleiste navigierbar sind. Ein Klick scrollt zur entsprechenden Sektion.
    * **Dynamische Textgenerierung:** Die Anwendung generiert für jeden Abschnitt professionell formulierte, englischsprachige Texte, die die **aktuellsten Analyseergebnisse** (aus den Vergleichen mit Literatur- und Brute-Force-Kriterien) dynamisch integrieren und korrekt formatieren (z.B. *P* < .001).
    * **Eingebettete Inhalte:** Tabellen und Abbildungen werden direkt im Textfluss generiert, inklusive eines gerenderten Flowcharts in den Ergebnissen.
    * **BF-Metrik-Auswahl:** Ein Dropdown-Menü erlaubt die Auswahl, welches Ergebnis der Brute-Force-Optimierung im Text zitiert werden soll.

### 3.6. Export Tab
* **Zweck:** Zentraler Hub für den Export aller relevanten Daten und Ergebnisse.
* **Komponenten & Workflow:**
    * **Export-Kategorien:** Optionen sind in "Single Exports" und "Export Packages (.zip)" unterteilt.
    * **Kontext-Sensitivität:** Alle Exporte basieren auf der aktuell gewählten globalen Kohorte. Nicht verfügbare Exporte (z.B. Brute-Force-Report, falls nie ausgeführt) sind deaktiviert.
    * **Verfügbare Exporte:** Umfassen u.a. gefilterte Rohdaten (CSV), Analysetabellen (MD), Statistikberichte (CSV), Brute-Force-Berichte (TXT), einen umfassenden HTML-Analysebericht sowie ZIP-Archive, die alle Grafiken oder Markdown-Texte bündeln.

## 4. Technischer Anhang

### 4.1. Schlüsseltechnologien
* **Kern:** HTML5, CSS3, JavaScript (ES6+)
* **UI/Layout:** Bootstrap 5
* **Datenvisualisierung:** D3.js
* **Asynchrone Berechnung:** Web Workers
* **UI-Verbesserungen:** Tippy.js
* **Dateiverarbeitung:** PapaParse, JSZip, html2canvas

### 4.2. Glossar
* **AS:** Avocado Sign
* **AUC:** Area Under the Curve. Ein Maß für die Gesamtleistung eines diagnostischen Tests.
* **BF:** Brute-Force. Eine erschöpfende Suchmethode zur Identifizierung optimaler Parameter.
* **CI:** Confidence Interval (Konfidenzintervall).
* **nRCT:** Neoadjuvant Chemoradiotherapy.
* **NPV:** Negative Predictive Value (Negativer prädiktiver Wert).
* **OR:** Odds Ratio (Chancenverhältnis).
* **PPV:** Positive Predictive Value (Positiver prädiktiver Wert).
* **RD:** Risk Difference (Risikodifferenz).
* **T2w:** T2-weighted (T2-gewichtet). Eine spezifische Art von MRT-Sequenz.
